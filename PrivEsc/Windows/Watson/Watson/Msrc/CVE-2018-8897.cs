using System.Linq;
using System.Collections.Generic;

namespace Watson.Msrc
{
    internal static class CVE_2018_8897
    {
        private const string name = "CVE-2018-8897";

        public static void Check(VulnerabilityCollection vulnerabilities, string BuildNumber, List<string> installedKBs)
        {
            List<string> Supersedence = new List<string>();

            switch (BuildNumber)
            {
                case "15063":

                    Supersedence.AddRange(new string[]
                    {
                        "4103731"
                    });

                    break;

                case "16299":

                    Supersedence.AddRange(new string[]
                    {
                        "4103727", "4103714", "4284819", "4284822", "4338817", "4338825", "4345420",
                        "4343893", "4343897", "4457136", "4457142", "4464217", "4462918", "4462932",
                        "4467681", "4467686", "4471329", "4483232", "4480967", "4480978", "4486996",
                        "4487021", "4489886", "4489890", "4493440", "4493441", "4499147", "4499179",
                        "4505062"
                    });

                    break;

                case "17134":

                    Supersedence.AddRange(new string[]
                    {
                        "4103721", "4100403", "4284835", "4284848", "4338819", "4340917", "4345421",
                        "4343909", "4346783", "4457128", "4458469", "4464218", "4462919", "4462933",
                        "4467702", "4471324", "4483234", "4480966", "4480976", "4487017", "4487029",
                        "4489868", "4489894", "4493437", "4493464", "4499167", "4499183", "4505064"
                    });

                    break;

                default:
                    return;

            }

            IEnumerable<string> x = Supersedence.Intersect(installedKBs);

            if (!x.Any())
                vulnerabilities.SetAsVulnerable(name);
        }
    }
}